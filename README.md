# üöÄ VokaFlow Backend

<div align="center">

![VokaFlow Logo](static/img/vokaflow-logo.png)

**Sistema de Comunicaci√≥n Avanzado con IA, Traducci√≥n y Reconocimiento de Voz**

[![Python](https://img.shields.io/badge/Python-3.12+-blue.svg)](https://python.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)](https://fastapi.tiangolo.com)
[![Redis](https://img.shields.io/badge/Redis-7.0+-red.svg)](https://redis.io)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Production%20Ready-brightgreen.svg)]()

[üåê Demo](http://localhost:8000) ‚Ä¢ [üìñ Documentaci√≥n](http://localhost:8000/docs) ‚Ä¢ [üöÄ Instalaci√≥n](#instalaci√≥n) ‚Ä¢ [ü§ù Contribuir](#contribuir)

</div>

---

## üìã Tabla de Contenidos

- [‚ú® Caracter√≠sticas](#-caracter√≠sticas)
- [üèóÔ∏è Arquitectura](#Ô∏è-arquitectura)
- [üöÄ Instalaci√≥n](#-instalaci√≥n)
  - [üê≥ Docker (Recomendado)](#-docker-recomendado)
  - [üíª Instalaci√≥n Manual](#-instalaci√≥n-manual)
  - [üîß Servicio Persistente](#-servicio-persistente)
- [‚öôÔ∏è Configuraci√≥n](#Ô∏è-configuraci√≥n)
- [üéØ Uso](#-uso)
- [üìä API Endpoints](#-api-endpoints)
- [üß† Vicky AI](#-vicky-ai)
- [üî• High Scale Tasks](#-high-scale-tasks)
- [üèÉ Desarrollo](#-desarrollo)
- [üìà Monitoreo](#-monitoreo)
- [ü§ù Contribuir](#-contribuir)
- [üìÑ Licencia](#-licencia)

## ‚ú® Caracter√≠sticas

### ü§ñ **Inteligencia Artificial - Vicky**
- üß† **Cerebro Din√°mico** con balance hemisf√©rico (t√©cnico/emocional)
- üîÑ **Contexto Persistente** entre conversaciones
- üìö **Memoria Avanzada** con capacidades de aprendizaje
- üé≠ **Personalidad Adaptativa** basada en el usuario

### üåç **Sistema de Traducci√≥n**
- üî§ **+10 Idiomas** soportados
- üöÄ **Traducci√≥n en Tiempo Real**
- üìä **Estad√≠sticas de Uso** detalladas
- üíæ **Historial Completo** de traducciones

### üé§ **Procesamiento de Voz**
- üó£Ô∏è **Speech-to-Text** (STT) con Whisper
- üîä **Text-to-Speech** (TTS) con voces personalizadas
- üéµ **Voces Sint√©ticas** con entrenamiento personalizado
- üìº **Gesti√≥n de Samples** de audio

### üî• **Sistema de Tareas de Alta Escala**
- ‚ö° **Millones de solicitudes** por segundo
- üîÑ **Auto-escalado** din√°mico
- üìä **Monitoreo en Tiempo Real**
- üõ°Ô∏è **Tolerancia a Fallos** con Dead Letter Queue

### üñ•Ô∏è **Integraci√≥n Hardware**
- üì∑ **Kinect Support** con streaming en tiempo real
- üé• **Video/Audio** processing
- üì° **Webhooks** para integraciones externas

### üîê **Seguridad y Autenticaci√≥n**
- üîë **JWT Authentication** con refresh tokens
- üõ°Ô∏è **API Keys** management
- üë• **Multi-usuario** con roles
- üîí **Rate Limiting** y protecci√≥n DDoS

### üìä **Monitoreo y Analytics**
- üìà **M√©tricas en Tiempo Real**
- üö® **Sistema de Alertas**
- üìã **Logs Estructurados**
- üíæ **Backup Autom√°tico**

## üèóÔ∏è Arquitectura

```mermaid
graph TB
    subgraph "Cliente"
        Web[Web App]
        Mobile[Mobile App]
        API_Client[API Client]
    end
    
    subgraph "VokaFlow Backend"
        Gateway[FastAPI Gateway]
        Auth[Authentication]
        
        subgraph "Core Services"
            Vicky[Vicky AI Engine]
            Translator[Translation Service]
            TTS[Text-to-Speech]
            STT[Speech-to-Text]
        end
        
        subgraph "High Scale System"
            TaskManager[Task Manager]
            Workers[Worker Pools]
            Scheduler[Task Scheduler]
        end
        
        subgraph "Data Layer"
            DB[(SQLite/PostgreSQL)]
            Redis[(Redis Cache)]
            Files[File Storage]
        end
    end
    
    subgraph "External Services"
        Kinect[Kinect Hardware]
        Webhooks[External APIs]
    end
    
    Web --> Gateway
    Mobile --> Gateway
    API_Client --> Gateway
    
    Gateway --> Auth
    Gateway --> Vicky
    Gateway --> Translator
    Gateway --> TTS
    Gateway --> STT
    
    Vicky --> TaskManager
    TaskManager --> Workers
    Workers --> Scheduler
    
    Auth --> Redis
    Vicky --> DB
    Translator --> DB
    TaskManager --> Redis
    
    Gateway --> Kinect
    Gateway --> Webhooks
```

## üöÄ Instalaci√≥n

### üê≥ Docker (Recomendado)

```bash
# Clonar repositorio
git clone https://github.com/tu-usuario/vokaflow-backend.git
cd vokaflow-backend

# Construir y ejecutar con Docker Compose
docker-compose up -d

# Verificar que funciona
curl http://localhost:8000/health
```

### üíª Instalaci√≥n Manual

#### Requisitos
- Python 3.12+
- Redis 7.0+
- SQLite/PostgreSQL
- OpenCV 4.5+
- libfreenect (para Kinect)

#### Pasos

```bash
# 1. Clonar repositorio
git clone https://github.com/tu-usuario/vokaflow-backend.git
cd vokaflow-backend

# 2. Crear entorno virtual
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# 3. Instalar dependencias
pip install -r requirements.txt

# 4. Configurar variables de entorno
cp .env.example .env
# Editar .env con tu configuraci√≥n

# 5. Inicializar base de datos
python -c "from src.main import *; Base.metadata.create_all(bind=engine)"

# 6. Ejecutar servidor
python src/main.py
```

### üîß Servicio Persistente (Linux)

Para configurar VokaFlow como servicio del sistema:

```bash
# Hacer ejecutable el script de gesti√≥n
chmod +x manage-vokaflow.sh

# Instalar como servicio
./manage-vokaflow.sh install

# Comandos de gesti√≥n
./manage-vokaflow.sh status    # Ver estado
./manage-vokaflow.sh start     # Iniciar
./manage-vokaflow.sh stop      # Detener
./manage-vokaflow.sh restart   # Reiniciar
./manage-vokaflow.sh logs      # Ver logs
./manage-vokaflow.sh health    # Verificar salud
```

## ‚öôÔ∏è Configuraci√≥n

### Variables de Entorno

```env
# Servidor
HOST=0.0.0.0
PORT=8000
DEBUG=False
ENVIRONMENT=production

# Base de Datos
DATABASE_URL=sqlite:///./vokaflow.db
# DATABASE_URL=postgresql://user:pass@localhost/vokaflow

# Redis
REDIS_URL=redis://localhost:6379

# Seguridad
SECRET_KEY=tu-clave-secreta-super-segura
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=10080

# Archivos
UPLOADS_DIR=./uploads
MODELS_DIR=./models
MAX_UPLOAD_SIZE=104857600

# APIs Externas
OPENAI_API_KEY=tu-clave-openai
GOOGLE_TRANSLATE_KEY=tu-clave-google

# Kinect
ENABLE_KINECT=true
KINECT_DEVICE_ID=0
```

## üéØ Uso

### Inicio R√°pido

```python
import requests

# Health Check
response = requests.get("http://localhost:8000/health")
print(response.json())

# Traducir texto
translation = requests.post("http://localhost:8000/api/translate", json={
    "text": "Hola mundo",
    "target_lang": "en"
})
print(translation.json())

# Chatear con Vicky
chat = requests.post("http://localhost:8000/api/vicky/process", json={
    "message": "¬øCu√°l es el sentido de la vida?",
    "user_id": "usuario123"
})
print(chat.json())
```

### Enviar Tareas de Alta Escala

```python
# Enviar tarea computacional
task = requests.post("http://localhost:8000/api/high-scale-tasks/submit", json={
    "function_name": "math.sqrt",
    "args": [16],
    "priority": "HIGH",
    "worker_type": "CPU_INTENSIVE"
})
print(f"Task ID: {task.json()['task_id']}")

# Ver m√©tricas del sistema
metrics = requests.get("http://localhost:8000/api/high-scale-tasks/metrics")
print(metrics.json())
```

## üìä API Endpoints

### üè• Health & Status
- `GET /health` - Health check b√°sico
- `GET /api/health/` - Health check detallado
- `GET /api/health/complete` - Health check completo

### üîê Autenticaci√≥n
- `POST /api/auth/token` - Obtener token de acceso
- `POST /api/auth/register` - Registrar nuevo usuario
- `GET /api/users/me` - Informaci√≥n del usuario actual

### üåç Traducci√≥n
- `POST /api/translate` - Traducir texto
- `GET /api/translate/languages` - Idiomas soportados
- `GET /api/translate/history` - Historial de traducciones
- `GET /api/translate/stats` - Estad√≠sticas de uso

### ü§ñ Vicky AI
- `POST /api/vicky/process` - Procesar mensaje
- `GET /api/vicky/status` - Estado del sistema
- `POST /api/vicky/hemisphere` - Ajustar balance hemisf√©rico

### üî• High Scale Tasks
- `POST /api/high-scale-tasks/submit` - Enviar tarea
- `GET /api/high-scale-tasks/metrics` - M√©tricas del sistema
- `GET /api/high-scale-tasks/status` - Estado general
- `POST /api/high-scale-tasks/control` - Control del sistema
- `GET /api/high-scale-tasks/dlq` - Dead Letter Queue

### üé§ Voz
- `POST /api/tts/synthesize` - Text-to-Speech
- `POST /api/stt/transcribe` - Speech-to-Text
- `GET /api/voice/samples` - Muestras de voz
- `POST /api/voice/upload` - Subir muestra de voz

### üìä Monitoreo
- `GET /api/monitoring/system` - M√©tricas del sistema
- `GET /api/monitoring/api` - M√©tricas de la API
- `GET /api/monitoring/alerts` - Alertas activas

### üîß Administraci√≥n
- `GET /api/admin/users` - Gesti√≥n de usuarios
- `GET /api/admin/logs` - Logs del sistema
- `POST /api/admin/backup` - Crear backup
- `POST /api/system/restart` - Reiniciar sistema

## üß† Vicky AI

Vicky es el motor de IA conversacional de VokaFlow con capacidades avanzadas:

### Caracter√≠sticas
- **Balance Hemisf√©rico**: Ajusta entre respuestas t√©cnicas y emocionales
- **Contexto Persistente**: Mantiene el contexto entre conversaciones
- **Aprendizaje Continuo**: Mejora con cada interacci√≥n
- **Multi-modal**: Procesa texto, voz e im√°genes

### Uso Avanzado

```python
# Configurar balance hemisf√©rico
requests.post("http://localhost:8000/api/vicky/hemisphere", json={
    "action": "set",
    "technical": 0.7,
    "emotional": 0.3
})

# Conversaci√≥n con contexto
requests.post("http://localhost:8000/api/vicky/process", json={
    "message": "Expl√≠came machine learning",
    "context": {"nivel": "principiante", "interes": "desarrollo"},
    "session_id": "sesion_123"
})
```

## üî• High Scale Tasks

Sistema dise√±ado para manejar millones de tareas concurrentes:

### Tipos de Workers
- **CPU_INTENSIVE**: C√°lculos matem√°ticos complejos
- **IO_INTENSIVE**: Operaciones de archivo/base de datos
- **MEMORY_INTENSIVE**: Procesamiento de grandes datasets
- **NETWORK_INTENSIVE**: Llamadas a APIs externas
- **GENERAL_PURPOSE**: Tareas generales

### Monitoreo

```bash
# Ver estado en tiempo real
curl http://localhost:8000/api/high-scale-tasks/metrics

# Enviar tareas de demostraci√≥n
curl -X POST http://localhost:8000/api/high-scale-tasks/demo/submit-demo-tasks?count=10
```

## üèÉ Desarrollo

### Configurar Entorno de Desarrollo

```bash
# Instalar dependencias de desarrollo
pip install -r requirements-dev.txt

# Pre-commit hooks
pre-commit install

# Tests
pytest tests/ -v

# Coverage
pytest --cov=src tests/

# Linting
flake8 src/
black src/
isort src/
```

### Estructura del Proyecto

```
vokaflow-backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # Punto de entrada
‚îÇ   ‚îî‚îÄ‚îÄ backend/
‚îÇ       ‚îú‚îÄ‚îÄ core/               # L√≥gica central
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ vicky/          # Motor de IA
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ high_scale_task_manager.py
‚îÇ       ‚îú‚îÄ‚îÄ routers/            # Endpoints de API
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ translate.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ vicky.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ high_scale_tasks.py
‚îÇ       ‚îî‚îÄ‚îÄ utils/              # Utilidades
‚îú‚îÄ‚îÄ static/                     # Archivos est√°ticos
‚îú‚îÄ‚îÄ tests/                      # Tests
‚îú‚îÄ‚îÄ docs/                       # Documentaci√≥n
‚îú‚îÄ‚îÄ scripts/                    # Scripts de utilidad
‚îú‚îÄ‚îÄ manage-vokaflow.sh         # Script de gesti√≥n
‚îú‚îÄ‚îÄ requirements.txt           # Dependencias
‚îú‚îÄ‚îÄ Dockerfile                 # Container Docker
‚îú‚îÄ‚îÄ docker-compose.yml         # Compose config
‚îî‚îÄ‚îÄ README.md                  # Este archivo
```

## üìà Monitoreo

### Logs

```bash
# Logs del servicio
journalctl -u vokaflow-backend.service -f

# Logs de la aplicaci√≥n
tail -f logs/vokaflow_backend.log

# M√©tricas del sistema
curl http://localhost:8000/api/monitoring/system
```

### Alertas

VokaFlow incluye alertas autom√°ticas para:
- üî¥ **CPU > 80%**
- üü° **Memoria > 85%**
- üîµ **Disco > 90%**
- ‚ö†Ô∏è **Fallos en Redis**
- üìà **API response time > 2s**

## ü§ù Contribuir

¬°Las contribuciones son bienvenidas! Por favor:

1. Fork el proyecto
2. Crea una branch para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add: Amazing Feature'`)
4. Push a la branch (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

### Est√°ndares de C√≥digo
- Python 3.12+
- Type hints obligatorios
- Docstrings para todas las funciones
- Tests para nuevo c√≥digo
- Coverage m√≠nimo 80%

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver `LICENSE` para m√°s detalles.

---

<div align="center">

**¬øTe gusta VokaFlow? ¬°Dale una ‚≠ê!**

Desarrollado con ‚ù§Ô∏è por el equipo de VokaFlow

[üåê Website](https://vokaflow.com) ‚Ä¢ [üìß Email](mailto:contact@vokaflow.com) ‚Ä¢ [üê¶ Twitter](https://twitter.com/vokaflow)

</div> 